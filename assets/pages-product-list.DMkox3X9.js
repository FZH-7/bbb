import{k as a,a8 as s,_ as e,U as t,a6 as l,c as i,w as o,v as u,o as r,L as c,A as n,a as p,G as d,B as f,C as m,H as v}from"./vendor.Ckgv2xgH.js";import{p as _}from"./product.CkM9Osij.js";import{u as g}from"./useSystem.Wa4UmrYm.js";import{V as h}from"./VirtualList.HuLulpwA.js";import"./request.Bx5oBM20.js";const y=e({__name:"list",setup(e){const y=a("商品列表"),{navTo:j}=g(),{list:k,loading:w,onRefresh:C}=function(e){const t=a([]),l=a(0),i=a(!1),o=a(!1),u=s({page:1,pageSize:10}),r=async(a=!1)=>{if(!(i.value||o.value&&!a)){a&&(u.page=1,o.value=!1),i.value=!0;try{const s=await e(u);s&&s.list&&(t.value=a?s.list:[...t.value,...s.list],l.value=s.total||0,t.value.length>=l.value?o.value=!0:u.page++)}finally{i.value=!1}}};return{list:t,total:l,loading:i,finished:o,params:u,loadData:r,onRefresh:()=>r(!0),onLoadMore:()=>r(!1)}}(_.getProducts);t(a=>{a.title&&(y.value=a.title,l({title:a.title})),C()});return(a,s)=>{const e=d,t=f,l=u;return r(),i(l,{class:"container"},{default:o(()=>[n(k).length>0?(r(),i(l,{key:0,class:"list-wrapper"},{default:o(()=>[p(h,{listData:n(k),itemSize:120,height:"100vh"},{default:o(({item:a})=>[p(l,{class:"product-item",onClick:s=>(a=>j(`/pages/product/product?id=${a.id}`))(a)},{default:o(()=>[p(e,{src:a.cover,mode:"aspectFill",class:"p-img"},null,8,["src"]),p(l,{class:"p-info"},{default:o(()=>[p(t,{class:"p-name"},{default:o(()=>[m(v(a.name),1)]),_:2},1024),p(l,{class:"p-price-box"},{default:o(()=>[p(t,{class:"symbol"},{default:o(()=>[m("¥")]),_:1}),p(t,{class:"price"},{default:o(()=>[m(v(a.price),1)]),_:2},1024),p(t,{class:"sales"},{default:o(()=>[m(v(a.sales)+"人付款",1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]),_:1},8,["listData"])]),_:1})):!1===n(w)?(r(),i(l,{key:1,class:"empty"},{default:o(()=>[p(t,null,{default:o(()=>[m("暂无相关商品")]),_:1})]),_:1})):c("",!0)]),_:1})}}},[["__scopeId","data-v-9711540f"]]);export{y as default};

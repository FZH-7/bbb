import{_ as e,k as a,U as l,a6 as s,c as t,w as d,v as u,o,a as n,B as c,C as i,a1 as r,a7 as m,L as p,a0 as f,N as v,Q as _}from"./vendor.Ckgv2xgH.js";import{a as h}from"./address.BOahIuM3.js";import{u as y}from"./useSystem.DX_vEvkG.js";import"./request.Bx5oBM20.js";const g=e({__name:"addressManage",setup(e){const{goBack:g}=y(),V=a({name:"",phone:"",address:"",province:"",city:"",area:"",is_default:!1}),w=a("");l(async e=>{if(e.id){s({title:"编辑收货地址"});const a=await h.getAddressById(e.id);a&&(V.value=a,w.value=[a.province,a.city,a.area].filter(Boolean).join(" "))}});const b=e=>{V.value.is_default=e.detail.value},k=async()=>{if(!V.value.name||!V.value.phone||!V.value.address)return void v({title:"请填写完整信息",icon:"none"});const e=w.value.split(" ");e.length>0&&(V.value.province=e[0]),e.length>1&&(V.value.city=e[1]),e.length>2&&(V.value.area=e[2]);let a=!1;a=V.value.id?await h.updateAddress(V.value.id,V.value,{showLoading:!0,loadingText:"正在保存..."}):await h.createAddress(V.value,{showLoading:!0,loadingText:"正在创建..."}),a&&(v({title:"保存成功"}),setTimeout(()=>g(),800))},C=async()=>{_({content:"确定要删除该地址吗？",success:async e=>{if(e.confirm){await h.deleteAddress(V.value.id,{showLoading:!0})&&(v({title:"已删除"}),setTimeout(()=>g(),800))}}})};return(e,a)=>{const l=c,s=r,v=u,_=m,h=f;return o(),t(v,{class:"container"},{default:d(()=>[n(v,{class:"form-group"},{default:d(()=>[n(v,{class:"form-item"},{default:d(()=>[n(l,{class:"label"},{default:d(()=>[i("联系人")]),_:1}),n(s,{class:"input",type:"text",modelValue:V.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value.name=e),placeholder:"请填写收货人姓名"},null,8,["modelValue"])]),_:1}),n(v,{class:"form-item"},{default:d(()=>[n(l,{class:"label"},{default:d(()=>[i("手机号")]),_:1}),n(s,{class:"input",type:"number",modelValue:V.value.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value.phone=e),placeholder:"请填写收货人手机号"},null,8,["modelValue"])]),_:1}),n(v,{class:"form-item"},{default:d(()=>[n(l,{class:"label"},{default:d(()=>[i("收货地址")]),_:1}),n(s,{class:"input",type:"text",modelValue:V.value.address,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value.address=e),placeholder:"街道、楼牌号等"},null,8,["modelValue"])]),_:1}),n(v,{class:"form-item"},{default:d(()=>[n(l,{class:"label"},{default:d(()=>[i("城市区域")]),_:1}),n(s,{class:"input",type:"text",modelValue:w.value,"onUpdate:modelValue":a[3]||(a[3]=e=>w.value=e),placeholder:"省/市/区 (选填)"},null,8,["modelValue"])]),_:1}),n(v,{class:"form-item switch-item"},{default:d(()=>[n(l,{class:"label"},{default:d(()=>[i("设为默认地址")]),_:1}),n(_,{checked:V.value.is_default,color:"#00CBCC",onChange:b},null,8,["checked"])]),_:1})]),_:1}),n(v,{class:"footer-btn"},{default:d(()=>[n(h,{class:"save-btn",type:"primary",onClick:k},{default:d(()=>[i("保存")]),_:1}),V.value.id?(o(),t(h,{key:0,class:"del-btn",type:"warn",onClick:C},{default:d(()=>[i("删除")]),_:1})):p("",!0)]),_:1})]),_:1})}}},[["__scopeId","data-v-e77de2cc"]]);export{g as default};

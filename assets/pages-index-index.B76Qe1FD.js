import{_ as a,k as s,l as e,m as l,n as t,p as c,q as r,t as i,c as o,w as n,u as d,v as u,x as f,y as p,o as _,a as g,z as m,A as k,B as b,C as h,D as y,F as v,E as x,G as w,H as C,S as z,I as j,J as q,K as B,L as F,M as H,N as I}from"./vendor.Ckgv2xgH.js";import{r as L,s as S}from"./request.Bx5oBM20.js";import{u as D}from"./useSystem.Wa4UmrYm.js";import{V as P}from"./VirtualList.HuLulpwA.js";import{g as V}from"./image.BWdQ8Foy.js";const A={async getBanners(){const a=await L(async()=>S.from("banners").select("*").order("sort",{ascending:!0}),{requestId:"home_banners",showLoading:!1});return a&&a.data?a.data:[]},async getHotProducts(){const a=await L(async()=>S.from("goods").select("*").order("created_at",{ascending:!0}),{requestId:"home_hot_products",showLoading:!0});return a&&a.data?a.data:[]}},E=a({__name:"index",setup(a){const{navTo:L,statusBarHeight:S}=D(),E=s([]),G=s([]),J=s(0),K=["综合推荐","销量榜","新品上市"],M=s(280),N=e(()=>{const a=[];for(let s=0;s<G.value.length;s+=2)a.push(G.value.slice(s,s+2));return a}),T=()=>{M.value=d(564)},$=a=>{I({title:a,icon:"none"})};l(()=>{T(),t(T)}),c(()=>{r(T)}),i(()=>{(async()=>{E.value=await A.getBanners(),G.value=await A.getHotProducts()})(),T()});const O=a=>{const s=(null==a?void 0:a.id)||1;L(`/pages/product/product?id=${s}`)},Q=[{text:"限时抢购",icon:"fire-filled",bg:"#000000"},{text:"品牌闪购",icon:"shop-filled",bg:"#000000"},{text:"每日福利",icon:"gift-filled",bg:"#000000"},{text:"会员中心",icon:"vip-filled",bg:"#000000"}];return(a,s)=>{const e=u,l=f(p("uni-icons"),H),t=b,c=w,r=j,i=z,d=q;return _(),o(e,{class:"container"},{default:n(()=>[g(e,{style:m({height:k(S)+"px"}),class:"status-bar-spacer"},null,8,["style"]),g(e,{class:"header-bar"},{default:n(()=>[g(e,{class:"header-left"},{default:n(()=>[g(l,{type:"scan",size:"24",color:"#333"})]),_:1}),g(e,{class:"search-box",onClick:s[0]||(s[0]=a=>k(L)("/pages/search/search"))},{default:n(()=>[g(l,{type:"search",size:"18",color:"#999"}),g(t,{class:"placeholder"},{default:n(()=>[h("搜索热门商品")]),_:1})]),_:1}),g(e,{class:"header-right"},{default:n(()=>[g(l,{type:"chat",size:"24",color:"#333",onClick:s[1]||(s[1]=a=>$("消息功能开发中"))})]),_:1})]),_:1}),g(P,{listData:N.value,itemSize:M.value,height:"calc(100vh - 50px)"},{header:n(()=>[g(e,{class:"banner-wrapper"},{default:n(()=>[g(i,{class:"swiper","indicator-dots":"",autoplay:"",circular:"","indicator-color":"rgba(255, 255, 255, 0.5)","indicator-active-color":"#00CBCC"},{default:n(()=>[(_(!0),y(v,null,x(E.value,a=>(_(),o(r,{key:a.id},{default:n(()=>[g(e,{class:"swiper-item-inner",onClick:s=>(a=>{a.link&&L(a.link)})(a)},{default:n(()=>[g(c,{src:k(V)(a.image),mode:"aspectFill",class:"banner-img"},null,8,["src"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),g(e,{class:"nav-section"},{default:n(()=>[(_(),y(v,null,x(Q,(a,s)=>g(e,{class:"nav-item",key:s,onClick:s=>(a=>{switch(a.text){case"限时抢购":L("/pages/marketing/flash-sale");break;case"品牌闪购":L("/pages/marketing/brand-sale");break;case"每日福利":L("/pages/marketing/welfare");break;case"积分商城":L("/pages/product/list?title=积分商城");break;case"会员中心":L("/pages/user/member");break;default:$(a.text+" 功能开发中")}})(a)},{default:n(()=>[g(e,{class:"icon-box",style:m({background:a.bg})},{default:n(()=>[g(l,{type:a.icon,color:"#fff",size:"24"},null,8,["type"])]),_:2},1032,["style"]),g(t,{class:"nav-text"},{default:n(()=>[h(C(a.text),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1}),g(e,{class:"section-header"},{default:n(()=>[g(t,{class:"title"},{default:n(()=>[h("本周流行")]),_:1}),g(e,{class:"more"},{default:n(()=>[g(t,null,{default:n(()=>[h("查看更多")]),_:1}),g(l,{type:"arrowright",size:"12",color:"#999"})]),_:1})]),_:1}),g(d,{"scroll-x":"",class:"trending-scroll","show-scrollbar":"false"},{default:n(()=>[g(e,{class:"trending-list"},{default:n(()=>[(_(!0),y(v,null,x(G.value.slice(0,10),(a,s)=>(_(),o(e,{class:"trending-card",key:s,onClick:s=>O(a)},{default:n(()=>[g(c,{src:k(V)(a.cover),mode:"aspectFill",class:"t-img"},null,8,["src"]),g(t,{class:"t-title"},{default:n(()=>[h(C(a.name),1)]),_:2},1024),g(t,{class:"t-price"},{default:n(()=>[h("¥"+C(a.price),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),g(e,{class:"sticky-tabs"},{default:n(()=>[(_(),y(v,null,x(K,(a,s)=>g(e,{class:B(["tab-item",{active:J.value===s}]),key:s,onClick:a=>J.value=s},{default:n(()=>[h(C(a)+" ",1),J.value===s?(_(),o(e,{key:0,class:"indicator"})):F("",!0)]),_:2},1032,["class","onClick"])),64))]),_:1})]),default:n(({row:a})=>[g(e,{class:"product-row"},{default:n(()=>[(_(!0),y(v,null,x(a,a=>(_(),o(e,{class:"product-card",key:a.id,onClick:s=>O(a)},{default:n(()=>[g(e,{class:"card-img-box"},{default:n(()=>[g(c,{src:k(V)(a.cover),mode:"aspectFill",class:"p-img"},null,8,["src"])]),_:2},1024),g(e,{class:"p-info"},{default:n(()=>[g(t,{class:"p-title"},{default:n(()=>[h(C(a.name),1)]),_:2},1024),g(e,{class:"p-bottom"},{default:n(()=>[g(e,{class:"price-box"},{default:n(()=>[g(t,{class:"currency"},{default:n(()=>[h("¥")]),_:1}),g(t,{class:"price"},{default:n(()=>[h(C(a.price),1)]),_:2},1024)]),_:2},1024),g(e,{class:"add-btn"},{default:n(()=>[g(l,{type:"plus",size:"16",color:"#fff"})]),_:1})]),_:2},1024),g(t,{class:"p-sales"},{default:n(()=>[h(C(a.sales)+"人付款",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:1},8,["listData","itemSize"])]),_:1})}}},[["__scopeId","data-v-cb9d77af"]]);export{E as default};

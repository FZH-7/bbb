import{_ as a,k as s,m as t,p as e,c as l,w as o,v as c,o as r,a as u,B as d,C as n,H as i,G as f,A as p,J as m,D as _,F as v,E as g,K as b,z as h,a0 as k}from"./vendor.Ckgv2xgH.js";import{p as S}from"./product.CkM9Osij.js";import{u as y}from"./useSystem.Wa4UmrYm.js";import{g as w}from"./image.BWdQ8Foy.js";import"./request.Bx5oBM20.js";const x=a({__name:"flash-sale",setup(a){const{navTo:x}=y(),j=s("00"),C=s("00"),M=s("00");let R=null;const D=s(0),F=s([]),H=s([]),I=()=>{const a=(new Date).getHours(),s=a%2==0?a:a-1,t=[];for(let e=-1;e<4;e++){let a=s+2*e,l="",o=a;a<0?(o=24+a,l="已结束"):a>=24?(o=a-24,l="明日开始"):l=a<s?"已结束":a===s?"抢购中":"即将开始",t.push({time:`${o.toString().padStart(2,"0")}:00`,hour:a,status:l})}F.value=t,D.value=1},T=()=>{const a=new Date,s=a.getHours(),t=s%2==0?s+2:s+1,e=new Date;e.setHours(t,0,0,0);let l=Math.floor((e.getTime()-a.getTime())/1e3);if(l<=0)return void I();const o=Math.floor(l/3600),c=Math.floor(l%3600/60),r=l%60;j.value=o.toString().padStart(2,"0"),C.value=c.toString().padStart(2,"0"),M.value=r.toString().padStart(2,"0")};return t(()=>{I(),R&&clearInterval(R),R=setInterval(T,1e3),T(),(async()=>{const{list:a}=await S.getProducts({page:1,pageSize:10});a&&(H.value=a.map(a=>({...a,soldRate:Math.floor(80*Math.random())+10})))})()}),e(()=>{R&&clearInterval(R)}),(a,s)=>{const t=d,e=c,S=f,y=m,R=k;return r(),l(e,{class:"container"},{default:o(()=>[u(e,{class:"flash-header"},{default:o(()=>[u(e,{class:"header-content"},{default:o(()=>[u(t,{class:"title"},{default:o(()=>[n("限时抢购")]),_:1}),u(e,{class:"timer-box"},{default:o(()=>[u(t,{class:"label"},{default:o(()=>[n("距结束")]),_:1}),u(e,{class:"time-block"},{default:o(()=>[n(i(j.value),1)]),_:1}),u(t,{class:"colon"},{default:o(()=>[n(":")]),_:1}),u(e,{class:"time-block"},{default:o(()=>[n(i(C.value),1)]),_:1}),u(t,{class:"colon"},{default:o(()=>[n(":")]),_:1}),u(e,{class:"time-block"},{default:o(()=>[n(i(M.value),1)]),_:1})]),_:1})]),_:1}),u(S,{src:p(w)("/static/banner_new.png"),mode:"aspectFill",class:"header-bg"},null,8,["src"]),u(e,{class:"overlay"})]),_:1}),u(y,{"scroll-x":"",class:"time-tabs"},{default:o(()=>[(r(!0),_(v,null,g(F.value,(a,s)=>(r(),l(e,{class:b(["tab-item",{active:D.value===s}]),key:s,onClick:a=>D.value=s},{default:o(()=>[u(t,{class:"time"},{default:o(()=>[n(i(a.time),1)]),_:2},1024),u(t,{class:"status"},{default:o(()=>[n(i(a.status),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),u(e,{class:"product-list"},{default:o(()=>[(r(!0),_(v,null,g(H.value,(a,s)=>(r(),l(e,{class:"product-item",key:a.id,onClick:s=>(a=>{x(`/pages/product/product?id=${a.id}`)})(a)},{default:o(()=>[u(S,{src:p(w)(a.cover),mode:"aspectFill",class:"p-img"},null,8,["src"]),u(e,{class:"p-info"},{default:o(()=>[u(t,{class:"p-name"},{default:o(()=>[n(i(a.name),1)]),_:2},1024),u(e,{class:"p-meta"},{default:o(()=>[u(e,{class:"price-box"},{default:o(()=>[u(t,{class:"symbol"},{default:o(()=>[n("¥")]),_:1}),u(t,{class:"price"},{default:o(()=>[n(i(a.price),1)]),_:2},1024),u(t,{class:"original"},{default:o(()=>[n("¥"+i((1.5*a.price).toFixed(2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),u(e,{class:"progress-box"},{default:o(()=>[u(e,{class:"progress-bar"},{default:o(()=>[u(e,{class:"inner",style:h({width:a.soldRate+"%"})},null,8,["style"])]),_:2},1024),u(t,{class:"sold-text"},{default:o(()=>[n("已抢"+i(a.soldRate)+"%",1)]),_:2},1024)]),_:2},1024),u(R,{class:b(["buy-btn",{"sold-out":a.soldRate>=100}])},{default:o(()=>[n(i(a.soldRate>=100?"已抢光":"马上抢"),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})}}},[["__scopeId","data-v-9971dfe6"]]);export{x as default};

import{_ as a,k as s,m as t,p as e,c as l,w as o,v as c,o as u,a as r,B as d,C as n,H as i,G as f,J as p,D as _,F as m,E as v,K as g,z as b,a0 as h}from"./vendor.Ckgv2xgH.js";import{p as k}from"./product.CkM9Osij.js";import{u as y}from"./useSystem.Wa4UmrYm.js";import"./request.Bx5oBM20.js";const S=a({__name:"flash-sale",setup(a){const{navTo:S}=y(),x=s("00"),w=s("00"),j=s("00");let C=null;const M=s(0),R=s([]),D=s([]),F=()=>{const a=(new Date).getHours(),s=a%2==0?a:a-1,t=[];for(let e=-1;e<4;e++){let a=s+2*e,l="",o=a;a<0?(o=24+a,l="已结束"):a>=24?(o=a-24,l="明日开始"):l=a<s?"已结束":a===s?"抢购中":"即将开始",t.push({time:`${o.toString().padStart(2,"0")}:00`,hour:a,status:l})}R.value=t,M.value=1},H=()=>{const a=new Date,s=a.getHours(),t=s%2==0?s+2:s+1,e=new Date;e.setHours(t,0,0,0);let l=Math.floor((e.getTime()-a.getTime())/1e3);if(l<=0)return void F();const o=Math.floor(l/3600),c=Math.floor(l%3600/60),u=l%60;x.value=o.toString().padStart(2,"0"),w.value=c.toString().padStart(2,"0"),j.value=u.toString().padStart(2,"0")};return t(()=>{F(),C&&clearInterval(C),C=setInterval(H,1e3),H(),(async()=>{const{list:a}=await k.getProducts({page:1,pageSize:10});a&&(D.value=a.map(a=>({...a,soldRate:Math.floor(80*Math.random())+10})))})()}),e(()=>{C&&clearInterval(C)}),(a,s)=>{const t=d,e=c,k=f,y=p,C=h;return u(),l(e,{class:"container"},{default:o(()=>[r(e,{class:"flash-header"},{default:o(()=>[r(e,{class:"header-content"},{default:o(()=>[r(t,{class:"title"},{default:o(()=>[n("限时抢购")]),_:1}),r(e,{class:"timer-box"},{default:o(()=>[r(t,{class:"label"},{default:o(()=>[n("距结束")]),_:1}),r(e,{class:"time-block"},{default:o(()=>[n(i(x.value),1)]),_:1}),r(t,{class:"colon"},{default:o(()=>[n(":")]),_:1}),r(e,{class:"time-block"},{default:o(()=>[n(i(w.value),1)]),_:1}),r(t,{class:"colon"},{default:o(()=>[n(":")]),_:1}),r(e,{class:"time-block"},{default:o(()=>[n(i(j.value),1)]),_:1})]),_:1})]),_:1}),r(k,{src:"https://img.yzcdn.cn/vant/apple-1.jpg",mode:"aspectFill",class:"header-bg"}),r(e,{class:"overlay"})]),_:1}),r(y,{"scroll-x":"",class:"time-tabs"},{default:o(()=>[(u(!0),_(m,null,v(R.value,(a,s)=>(u(),l(e,{class:g(["tab-item",{active:M.value===s}]),key:s,onClick:a=>M.value=s},{default:o(()=>[r(t,{class:"time"},{default:o(()=>[n(i(a.time),1)]),_:2},1024),r(t,{class:"status"},{default:o(()=>[n(i(a.status),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1}),r(e,{class:"product-list"},{default:o(()=>[(u(!0),_(m,null,v(D.value,(a,s)=>(u(),l(e,{class:"product-item",key:a.id,onClick:s=>(a=>{S(`/pages/product/product?id=${a.id}`)})(a)},{default:o(()=>[r(k,{src:a.cover,mode:"aspectFill",class:"p-img"},null,8,["src"]),r(e,{class:"p-info"},{default:o(()=>[r(t,{class:"p-name"},{default:o(()=>[n(i(a.name),1)]),_:2},1024),r(e,{class:"p-meta"},{default:o(()=>[r(e,{class:"price-box"},{default:o(()=>[r(t,{class:"symbol"},{default:o(()=>[n("¥")]),_:1}),r(t,{class:"price"},{default:o(()=>[n(i(a.price),1)]),_:2},1024),r(t,{class:"original"},{default:o(()=>[n("¥"+i((1.5*a.price).toFixed(2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),r(e,{class:"progress-box"},{default:o(()=>[r(e,{class:"progress-bar"},{default:o(()=>[r(e,{class:"inner",style:b({width:a.soldRate+"%"})},null,8,["style"])]),_:2},1024),r(t,{class:"sold-text"},{default:o(()=>[n("已抢"+i(a.soldRate)+"%",1)]),_:2},1024)]),_:2},1024),r(C,{class:g(["buy-btn",{"sold-out":a.soldRate>=100}])},{default:o(()=>[n(i(a.soldRate>=100?"已抢光":"马上抢"),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})}}},[["__scopeId","data-v-d7cdeb91"]]);export{S as default};
